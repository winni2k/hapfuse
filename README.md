# hapfuse

This is my own fork of the SNPTools::hapfuse tool in [SNPTools v1.0](http://sourceforge.net/projects/snptools).

## Differences to SNPTools::hapfuse

* **Dependency on Boost for splitting input strings**.
  This allows me to avoid nasty buffer overruns when input VCFs contain too many samples.

* **Input VCFs must contain the GT, and APP or GP field**.
  APP stands for phred-scaled allelic probability.  SNPTools uses the AP field, which stands for allelic probability.

* **Input VCFs can have fields with arbitrary precision**.  SNPTools::hapfuse uses the AP field with fixed precision floats while hapfuse v0.4 accepts APP and GP fields of arbitrary precision.  

* **Speed and Reliability**.
  hapfuse v0.4 is likely slower than SNPTools::hapfuse as it makes less assumptions about the formatting of input VCF fields.  However, this also means that hapfuse v0.4 is less likely to mis-read input fields with custom-generated VCF files. 

* **Regression Tests**. hapfuse v0.4 comes with regression tests to make sure it works!

## WARNING
hapfuse v0.4 does not work with data generated by SNPTools::impute.  This is because I do not use the AP field and am too lazy to implement support for it.  Patches welcome.
